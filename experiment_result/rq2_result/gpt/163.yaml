compilation.log: |
  Starting >>> nav2_costmap_2d
  --- stderr: nav2_costmap_2d
  In file included from /opt/ros/humble/include/rclcpp/rclcpp/client.hpp:40,
                   from /opt/ros/humble/include/rclcpp/rclcpp/callback_group.hpp:24,
                   from /opt/ros/humble/include/rclcpp/rclcpp/any_executable.hpp:20,
                   from /opt/ros/humble/include/rclcpp/rclcpp/memory_strategy.hpp:25,
                   from /opt/ros/humble/include/rclcpp/rclcpp/memory_strategies.hpp:18,
                   from /opt/ros/humble/include/rclcpp/rclcpp/executor_options.hpp:20,
                   from /opt/ros/humble/include/rclcpp/rclcpp/executor.hpp:37,
                   from /opt/ros/humble/include/rclcpp/rclcpp/executors/multi_threaded_executor.hpp:25,
                   from /opt/ros/humble/include/rclcpp/rclcpp/executors.hpp:21,
                   from /opt/ros/humble/include/rclcpp/rclcpp/rclcpp.hpp:155,
                   from /opt/ros/humble/include/tf2_ros/tf2_ros/buffer_interface.hpp:48,
                   from /opt/ros/humble/include/tf2_geometry_msgs/tf2_geometry_msgs/tf2_geometry_msgs.hpp:60,
                   from /root/repos/nav_ws/src/nav2_costmap_2d/plugins/costmap_filters/keepout_filter.cpp:42:
  /root/repos/nav_ws/src/nav2_costmap_2d/plugins/costmap_filters/keepout_filter.cpp: In member function ‘void nav2_costmap_2d::KeepoutFilter::filterInfoCallback(nav2_msgs::msg::CostmapFilterInfo_<std::allocator<void> >::SharedPtr)’:
  /root/repos/nav_ws/src/nav2_costmap_2d/plugins/costmap_filters/keepout_filter.cpp:85:13: error: ‘class nav2_costmap_2d::KeepoutFilter’ has no member named ‘get_logger’
     85 |       this->get_logger(),
        |             ^~~~~~~~~~
  /root/repos/nav_ws/src/nav2_costmap_2d/plugins/costmap_filters/keepout_filter.cpp:85:13: error: ‘class nav2_costmap_2d::KeepoutFilter’ has no member named ‘get_logger’
  /root/repos/nav_ws/src/nav2_costmap_2d/plugins/costmap_filters/keepout_filter.cpp:84:5: error: template argument 1 is invalid
     84 |     RCLCPP_ERROR(
        |     ^~~~~~~~~~~~
  In file included from /opt/ros/humble/include/rclcpp/rclcpp/logging.hpp:24,
                   from /opt/ros/humble/include/rclcpp/rclcpp/client.hpp:40,
                   from /opt/ros/humble/include/rclcpp/rclcpp/callback_group.hpp:24,
                   from /opt/ros/humble/include/rclcpp/rclcpp/any_executable.hpp:20,
                   from /opt/ros/humble/include/rclcpp/rclcpp/memory_strategy.hpp:25,
                   from /opt/ros/humble/include/rclcpp/rclcpp/memory_strategies.hpp:18,
                   from /opt/ros/humble/include/rclcpp/rclcpp/executor_options.hpp:20,
                   from /opt/ros/humble/include/rclcpp/rclcpp/executor.hpp:37,
                   from /opt/ros/humble/include/rclcpp/rclcpp/executors/multi_threaded_executor.hpp:25,
                   from /opt/ros/humble/include/rclcpp/rclcpp/executors.hpp:21,
                   from /opt/ros/humble/include/rclcpp/rclcpp/rclcpp.hpp:155,
                   from /opt/ros/humble/include/tf2_ros/tf2_ros/buffer_interface.hpp:48,
                   from /opt/ros/humble/include/tf2_geometry_msgs/tf2_geometry_msgs/tf2_geometry_msgs.hpp:60,
                   from /root/repos/nav_ws/src/nav2_costmap_2d/plugins/costmap_filters/keepout_filter.cpp:42:
  /root/repos/nav_ws/src/nav2_costmap_2d/plugins/costmap_filters/keepout_filter.cpp:85:13: error: ‘class nav2_costmap_2d::KeepoutFilter’ has no member named ‘get_logger’
     85 |       this->get_logger(),
        |             ^~~~~~~~~~
  /root/repos/nav_ws/src/nav2_costmap_2d/plugins/costmap_filters/keepout_filter.cpp:85:13: error: ‘class nav2_costmap_2d::KeepoutFilter’ has no member named ‘get_logger’
     85 |       this->get_logger(),
        |             ^~~~~~~~~~
  In file included from /opt/ros/humble/include/rclcpp/rclcpp/client.hpp:40,
                   from /opt/ros/humble/include/rclcpp/rclcpp/callback_group.hpp:24,
                   from /opt/ros/humble/include/rclcpp/rclcpp/any_executable.hpp:20,
                   from /opt/ros/humble/include/rclcpp/rclcpp/memory_strategy.hpp:25,
                   from /opt/ros/humble/include/rclcpp/rclcpp/memory_strategies.hpp:18,
                   from /opt/ros/humble/include/rclcpp/rclcpp/executor_options.hpp:20,
                   from /opt/ros/humble/include/rclcpp/rclcpp/executor.hpp:37,
                   from /opt/ros/humble/include/rclcpp/rclcpp/executors/multi_threaded_executor.hpp:25,
                   from /opt/ros/humble/include/rclcpp/rclcpp/executors.hpp:21,
                   from /opt/ros/humble/include/rclcpp/rclcpp/rclcpp.hpp:155,
                   from /opt/ros/humble/include/tf2_ros/tf2_ros/buffer_interface.hpp:48,
                   from /opt/ros/humble/include/tf2_geometry_msgs/tf2_geometry_msgs/tf2_geometry_msgs.hpp:60,
                   from /root/repos/nav_ws/src/nav2_costmap_2d/plugins/costmap_filters/keepout_filter.cpp:42:
  /root/repos/nav_ws/src/nav2_costmap_2d/plugins/costmap_filters/keepout_filter.cpp:93:13: error: ‘class nav2_costmap_2d::KeepoutFilter’ has no member named ‘get_logger’
     93 |       this->get_logger(),
        |             ^~~~~~~~~~
  /root/repos/nav_ws/src/nav2_costmap_2d/plugins/costmap_filters/keepout_filter.cpp:93:13: error: ‘class nav2_costmap_2d::KeepoutFilter’ has no member named ‘get_logger’
  /root/repos/nav_ws/src/nav2_costmap_2d/plugins/costmap_filters/keepout_filter.cpp:92:5: error: template argument 1 is invalid
     92 |     RCLCPP_INFO(
        |     ^~~~~~~~~~~
  In file included from /opt/ros/humble/include/rclcpp/rclcpp/logging.hpp:24,
                   from /opt/ros/humble/include/rclcpp/rclcpp/client.hpp:40,
                   from /opt/ros/humble/include/rclcpp/rclcpp/callback_group.hpp:24,
                   from /opt/ros/humble/include/rclcpp/rclcpp/any_executable.hpp:20,
                   from /opt/ros/humble/include/rclcpp/rclcpp/memory_strategy.hpp:25,
                   from /opt/ros/humble/include/rclcpp/rclcpp/memory_strategies.hpp:18,
                   from /opt/ros/humble/include/rclcpp/rclcpp/executor_options.hpp:20,
                   from /opt/ros/humble/include/rclcpp/rclcpp/executor.hpp:37,
                   from /opt/ros/humble/include/rclcpp/rclcpp/executors/multi_threaded_executor.hpp:25,
                   from /opt/ros/humble/include/rclcpp/rclcpp/executors.hpp:21,
                   from /opt/ros/humble/include/rclcpp/rclcpp/rclcpp.hpp:155,
                   from /opt/ros/humble/include/tf2_ros/tf2_ros/buffer_interface.hpp:48,
                   from /opt/ros/humble/include/tf2_geometry_msgs/tf2_geometry_msgs/tf2_geometry_msgs.hpp:60,
                   from /root/repos/nav_ws/src/nav2_costmap_2d/plugins/costmap_filters/keepout_filter.cpp:42:
  /root/repos/nav_ws/src/nav2_costmap_2d/plugins/costmap_filters/keepout_filter.cpp:93:13: error: ‘class nav2_costmap_2d::KeepoutFilter’ has no member named ‘get_logger’
     93 |       this->get_logger(),
        |             ^~~~~~~~~~
  /root/repos/nav_ws/src/nav2_costmap_2d/plugins/costmap_filters/keepout_filter.cpp:93:13: error: ‘class nav2_costmap_2d::KeepoutFilter’ has no member named ‘get_logger’
     93 |       this->get_logger(),
        |             ^~~~~~~~~~
  /root/repos/nav_ws/src/nav2_costmap_2d/plugins/costmap_filters/keepout_filter.cpp:96:23: error: ‘class nav2_costmap_2d::KeepoutFilter’ has no member named ‘create_subscription’
     96 |     mask_sub_ = this->create_subscription<nav_msgs::msg::OccupancyGrid>(
        |                       ^~~~~~~~~~~~~~~~~~~
  /root/repos/nav_ws/src/nav2_costmap_2d/plugins/costmap_filters/keepout_filter.cpp:96:71: error: expected primary-expression before ‘>’ token
     96 |     mask_sub_ = this->create_subscription<nav_msgs::msg::OccupancyGrid>(
        |                                                                       ^
  /root/repos/nav_ws/src/nav2_costmap_2d/plugins/costmap_filters/keepout_filter.cpp: In lambda function:
  /root/repos/nav_ws/src/nav2_costmap_2d/plugins/costmap_filters/keepout_filter.cpp:99:15: error: ‘class nav2_costmap_2d::KeepoutFilter’ has no member named ‘processMaskMessage’
     99 |         this->processMaskMessage(mask_msg);
        |               ^~~~~~~~~~~~~~~~~~
  /root/repos/nav_ws/src/nav2_costmap_2d/plugins/costmap_filters/keepout_filter.cpp: In member function ‘void nav2_costmap_2d::KeepoutFilter::filterInfoCallback(nav2_msgs::msg::CostmapFilterInfo_<std::allocator<void> >::SharedPtr)’:
  /root/repos/nav_ws/src/nav2_costmap_2d/plugins/costmap_filters/keepout_filter.cpp:105:24: error: ‘using element_type = struct nav2_msgs::msg::CostmapFilterInfo_<std::allocator<void> >’ {aka ‘struct nav2_msgs::msg::CostmapFilterInfo_<std::allocator<void> >’} has no member named ‘global_frame’
    105 |   global_frame_ = msg->global_frame;
        |                        ^~~~~~~~~~~~
  In file included from /opt/ros/humble/include/rclcpp/rclcpp/client.hpp:40,
                   from /opt/ros/humble/include/rclcpp/rclcpp/callback_group.hpp:24,
                   from /opt/ros/humble/include/rclcpp/rclcpp/any_executable.hpp:20,
                   from /opt/ros/humble/include/rclcpp/rclcpp/memory_strategy.hpp:25,
                   from /opt/ros/humble/include/rclcpp/rclcpp/memory_strategies.hpp:18,
                   from /opt/ros/humble/include/rclcpp/rclcpp/executor_options.hpp:20,
                   from /opt/ros/humble/include/rclcpp/rclcpp/executor.hpp:37,
                   from /opt/ros/humble/include/rclcpp/rclcpp/executors/multi_threaded_executor.hpp:25,
                   from /opt/ros/humble/include/rclcpp/rclcpp/executors.hpp:21,
                   from /opt/ros/humble/include/rclcpp/rclcpp/rclcpp.hpp:155,
                   from /opt/ros/humble/include/tf2_ros/tf2_ros/buffer_interface.hpp:48,
                   from /opt/ros/humble/include/tf2_geometry_msgs/tf2_geometry_msgs/tf2_geometry_msgs.hpp:60,
                   from /root/repos/nav_ws/src/nav2_costmap_2d/plugins/costmap_filters/keepout_filter.cpp:42:
  /root/repos/nav_ws/src/nav2_costmap_2d/plugins/costmap_filters/keepout_filter.cpp:108:11: error: ‘class nav2_costmap_2d::KeepoutFilter’ has no member named ‘get_logger’
    108 |     this->get_logger(),
        |           ^~~~~~~~~~
  /root/repos/nav_ws/src/nav2_costmap_2d/plugins/costmap_filters/keepout_filter.cpp:108:11: error: ‘class nav2_costmap_2d::KeepoutFilter’ has no member named ‘get_logger’
  /root/repos/nav_ws/src/nav2_costmap_2d/plugins/costmap_filters/keepout_filter.cpp:107:3: error: template argument 1 is invalid
    107 |   RCLCPP_INFO(
        |   ^~~~~~~~~~~
  In file included from /opt/ros/humble/include/rclcpp/rclcpp/logging.hpp:24,
                   from /opt/ros/humble/include/rclcpp/rclcpp/client.hpp:40,
                   from /opt/ros/humble/include/rclcpp/rclcpp/callback_group.hpp:24,
                   from /opt/ros/humble/include/rclcpp/rclcpp/any_executable.hpp:20,
                   from /opt/ros/humble/include/rclcpp/rclcpp/memory_strategy.hpp:25,
                   from /opt/ros/humble/include/rclcpp/rclcpp/memory_strategies.hpp:18,
                   from /opt/ros/humble/include/rclcpp/rclcpp/executor_options.hpp:20,
                   from /opt/ros/humble/include/rclcpp/rclcpp/executor.hpp:37,
                   from /opt/ros/humble/include/rclcpp/rclcpp/executors/multi_threaded_executor.hpp:25,
                   from /opt/ros/humble/include/rclcpp/rclcpp/executors.hpp:21,
                   from /opt/ros/humble/include/rclcpp/rclcpp/rclcpp.hpp:155,
                   from /opt/ros/humble/include/tf2_ros/tf2_ros/buffer_interface.hpp:48,
                   from /opt/ros/humble/include/tf2_geometry_msgs/tf2_geometry_msgs/tf2_geometry_msgs.hpp:60,
                   from /root/repos/nav_ws/src/nav2_costmap_2d/plugins/costmap_filters/keepout_filter.cpp:42:
  /root/repos/nav_ws/src/nav2_costmap_2d/plugins/costmap_filters/keepout_filter.cpp:108:11: error: ‘class nav2_costmap_2d::KeepoutFilter’ has no member named ‘get_logger’
    108 |     this->get_logger(),
        |           ^~~~~~~~~~
  /root/repos/nav_ws/src/nav2_costmap_2d/plugins/costmap_filters/keepout_filter.cpp:108:11: error: ‘class nav2_costmap_2d::KeepoutFilter’ has no member named ‘get_logger’
    108 |     this->get_logger(),
        |           ^~~~~~~~~~
  gmake[2]: *** [CMakeFiles/filters.dir/build.make:76: CMakeFiles/filters.dir/plugins/costmap_filters/keepout_filter.cpp.o] Error 1
  gmake[1]: *** [CMakeFiles/Makefile2:321: CMakeFiles/filters.dir/all] Error 2
  gmake: *** [Makefile:146: all] Error 2
  ---
  Failed   <<< nav2_costmap_2d [4.37s, exited with code 2]

  Summary: 0 packages finished [4.70s]
    1 package failed: nav2_costmap_2d
    1 package had stderr output: nav2_costmap_2d
generate_code.cpp: |-
  void KeepoutFilter::filterInfoCallback(
    const nav2_msgs::msg::CostmapFilterInfo::SharedPtr msg)
  {
    // Check if the mask topic is provided in the filter info message
    if (msg->filter_mask_topic.empty()) {
      RCLCPP_ERROR(
        this->get_logger(),
        "KeepoutFilter: Received empty filter mask topic in CostmapFilterInfo message.");
      return;
    }

    // Subscribe to the mask topic if not already subscribed
    if (!mask_sub_ || mask_sub_->get_topic_name() != msg->filter_mask_topic) {
      RCLCPP_INFO(
        this->get_logger(),
        "KeepoutFilter: Subscribing to mask topic: %s", msg->filter_mask_topic.c_str());

      mask_sub_ = this->create_subscription<nav_msgs::msg::OccupancyGrid>(
        msg->filter_mask_topic, rclcpp::QoS(rclcpp::KeepLast(1)),
        [this](const nav_msgs::msg::OccupancyGrid::SharedPtr mask_msg) {
          this->processMaskMessage(mask_msg);
        });
    }

    // Update the mask frame and global frame
    mask_frame_ = msg->base;
    global_frame_ = msg->global_frame;

    RCLCPP_INFO(
      this->get_logger(),
      "KeepoutFilter: Updated mask frame to '%s' and global frame to '%s'.",
      mask_frame_.c_str(), global_frame_.c_str());
  }
ground_truth.cpp: |-
  void KeepoutFilter::filterInfoCallback(
    const nav2_msgs::msg::CostmapFilterInfo::SharedPtr msg)
  {
    std::lock_guard<CostmapFilter::mutex_t> guard(*getMutex());

    rclcpp_lifecycle::LifecycleNode::SharedPtr node = node_.lock();
    if (!node) {
      throw std::runtime_error{"Failed to lock node"};
    }

    if (!mask_sub_) {
      RCLCPP_INFO(
        logger_,
        "KeepoutFilter: Received filter info from %s topic.", filter_info_topic_.c_str());
    } else {
      RCLCPP_WARN(
        logger_,
        "KeepoutFilter: New costmap filter info arrived from %s topic. Updating old filter info.",
        filter_info_topic_.c_str());
      // Resetting previous subscriber each time when new costmap filter information arrives
      mask_sub_.reset();
    }

    // Checking that base and multiplier are set to their default values
    if (msg->base != BASE_DEFAULT || msg->multiplier != MULTIPLIER_DEFAULT) {
      RCLCPP_ERROR(
        logger_,
        "KeepoutFilter: For proper use of keepout filter base and multiplier"
        " in CostmapFilterInfo message should be set to their default values (%f and %f)",
        BASE_DEFAULT, MULTIPLIER_DEFAULT);
    }

    mask_topic_ = msg->filter_mask_topic;

    // Setting new filter mask subscriber
    RCLCPP_INFO(
      logger_,
      "KeepoutFilter: Subscribing to \"%s\" topic for filter mask...",
      mask_topic_.c_str());
    mask_sub_ = node->create_subscription<nav_msgs::msg::OccupancyGrid>(
      mask_topic_, rclcpp::QoS(rclcpp::KeepLast(1)).transient_local().reliable(),
      std::bind(&KeepoutFilter::maskCallback, this, std::placeholders::_1));
  }
