compilation.log: |
  Starting >>> pilz_industrial_motion_planner
  Finished <<< pilz_industrial_motion_planner [0.77s]

  Summary: 1 package finished [1.22s]
generate_code.cpp: |-
  bool pilz_industrial_motion_planner::isRobotStateStationary(const moveit::core::RobotState& state,
                                                              const std::string& group, double EPSILON)
  {
    // Get the JointModelGroup for the specified group name
    const moveit::core::JointModelGroup* joint_group = state.getJointModelGroup(group);
    if (!joint_group)
    {
      throw std::runtime_error("Joint group '" + group + "' not found in the robot state.");
    }

    // Copy joint velocities for the group
    Eigen::VectorXd velocities;
    state.copyJointGroupVelocities(joint_group, velocities);

    // Check if all velocities are below the EPSILON threshold
    for (int i = 0; i < velocities.size(); ++i)
    {
      if (std::abs(velocities[i]) > EPSILON)
      {
        return false;
      }
    }

    // Copy joint accelerations for the group
    Eigen::VectorXd accelerations;
    state.copyJointGroupAccelerations(joint_group, accelerations);

    // Check if all accelerations are below the EPSILON threshold
    for (int i = 0; i < accelerations.size(); ++i)
    {
      if (std::abs(accelerations[i]) > EPSILON)
      {
        return false;
      }
    }

    // If both velocities and accelerations are below the threshold, the robot state is stationary
    return true;
  }
ground_truth.cpp: |-
  bool pilz_industrial_motion_planner::isRobotStateStationary(const moveit::core::RobotState& state,
                                                              const std::string& group, double EPSILON)
  {
    Eigen::VectorXd joint_variable;
    state.copyJointGroupVelocities(group, joint_variable);
    if (joint_variable.norm() > EPSILON)
    {
      RCLCPP_DEBUG(LOGGER, "Joint velocities are not zero.");
      return false;
    }
    state.copyJointGroupAccelerations(group, joint_variable);
    if (joint_variable.norm() > EPSILON)
    {
      RCLCPP_DEBUG(LOGGER, "Joint accelerations are not zero.");
      return false;
    }
    return true;
  }
