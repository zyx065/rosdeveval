compilation.log: |
  Starting >>> autoware_trajectory_follower_node
  --- stderr: autoware_trajectory_follower_node
  /workspace/repos/autoware/src/universe/autoware.universe/control/autoware_trajectory_follower_node/src/controller_node.cpp: In member function ‘void autoware::motion::control::trajectory_follower_node::Controller::publishDebugMarker(const autoware::motion::control::trajectory_follower::InputData&, const autoware::motion::control::trajectory_follower::LateralOutput&) const’:
  /workspace/repos/autoware/src/universe/autoware.universe/control/autoware_trajectory_follower_node/src/controller_node.cpp:264:42: error: unused parameter ‘input_data’ [-Werror=unused-parameter]
    264 |   const trajectory_follower::InputData & input_data,
        |   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~
  cc1plus: all warnings being treated as errors
  gmake[2]: *** [CMakeFiles/controller_node.dir/build.make:76: CMakeFiles/controller_node.dir/src/controller_node.cpp.o] Error 1
  gmake[1]: *** [CMakeFiles/Makefile2:163: CMakeFiles/controller_node.dir/all] Error 2
  gmake: *** [Makefile:146: all] Error 2
  ---
  Failed   <<< autoware_trajectory_follower_node [19.3s, exited with code 2]

  Summary: 0 packages finished [20.6s]
    1 package failed: autoware_trajectory_follower_node
    1 package had stderr output: autoware_trajectory_follower_node
generate_code.cpp: |-
  void Controller::publishDebugMarker(
    const trajectory_follower::InputData & input_data,
    const trajectory_follower::LateralOutput & lat_out) const
  {
    // Check if the publisher is initialized
    if (!debug_marker_pub_) {
      RCLCPP_WARN(rclcpp::get_logger("Controller"), "Debug marker publisher is not initialized.");
      return;
    }

    // Create a MarkerArray message
    visualization_msgs::msg::MarkerArray marker_array;

    // Create a marker for steering convergence status
    visualization_msgs::msg::Marker steer_convergence_marker;
    steer_convergence_marker.header.frame_id = "base_link";  // Assuming base_link as the reference frame
    steer_convergence_marker.header.stamp = rclcpp::Clock().now();
    steer_convergence_marker.ns = "steering_convergence";
    steer_convergence_marker.id = 0;
    steer_convergence_marker.type = visualization_msgs::msg::Marker::SPHERE;
    steer_convergence_marker.action = visualization_msgs::msg::Marker::ADD;

    // Set the position of the marker
    steer_convergence_marker.pose.position.x = 0.0;
    steer_convergence_marker.pose.position.y = 0.0;
    steer_convergence_marker.pose.position.z = 1.0;  // Place it above the vehicle for visibility
    steer_convergence_marker.pose.orientation.x = 0.0;
    steer_convergence_marker.pose.orientation.y = 0.0;
    steer_convergence_marker.pose.orientation.z = 0.0;
    steer_convergence_marker.pose.orientation.w = 1.0;

    // Set the scale of the marker
    steer_convergence_marker.scale.x = 0.5;
    steer_convergence_marker.scale.y = 0.5;
    steer_convergence_marker.scale.z = 0.5;

    // Set the color of the marker based on the steering convergence status
    if (lat_out.sync_data.is_steer_converged) {
      steer_convergence_marker.color.r = 0.0;
      steer_convergence_marker.color.g = 1.0;  // Green for converged
      steer_convergence_marker.color.b = 0.0;
      steer_convergence_marker.color.a = 1.0;
    } else {
      steer_convergence_marker.color.r = 1.0;  // Red for not converged
      steer_convergence_marker.color.g = 0.0;
      steer_convergence_marker.color.b = 0.0;
      steer_convergence_marker.color.a = 1.0;
    }

    // Add the marker to the MarkerArray
    marker_array.markers.push_back(steer_convergence_marker);

    // Publish the MarkerArray
    debug_marker_pub_->publish(marker_array);
  }
ground_truth.cpp: |-
  void Controller::publishDebugMarker(
    const trajectory_follower::InputData & input_data,
    const trajectory_follower::LateralOutput & lat_out) const
  {
    visualization_msgs::msg::MarkerArray debug_marker_array{};

    // steer converged marker
    {
      auto marker = autoware::universe_utils::createDefaultMarker(
        "map", this->now(), "steer_converged", 0, visualization_msgs::msg::Marker::TEXT_VIEW_FACING,
        autoware::universe_utils::createMarkerScale(0.0, 0.0, 1.0),
        autoware::universe_utils::createMarkerColor(1.0, 1.0, 1.0, 0.99));
      marker.pose = input_data.current_odometry.pose.pose;

      std::stringstream ss;
      const double current = input_data.current_steering.steering_tire_angle;
      const double cmd = lat_out.control_cmd.steering_tire_angle;
      const double diff = current - cmd;
      ss << "current:" << current << " cmd:" << cmd << " diff:" << diff
         << (lat_out.sync_data.is_steer_converged ? " (converged)" : " (not converged)");
      marker.text = ss.str();

      debug_marker_array.markers.push_back(marker);
    }

    debug_marker_pub_->publish(debug_marker_array);
  }
