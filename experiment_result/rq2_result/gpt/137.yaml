compilation.log: |
  Starting >>> moveit_core
  --- stderr: moveit_core
  /root/repos/moveit_ws/src/moveit2/moveit_core/collision_detection/src/world.cpp: In member function ‘bool collision_detection::World::moveShapeInObject(const string&, const ShapeConstPtr&, const Isometry3d&)’:
  /root/repos/moveit_ws/src/moveit2/moveit_core/collision_detection/src/world.cpp:251:33: error: ‘MODIFY’ is not a member of ‘collision_detection::World::Action’
    251 |             notify(obj, Action::MODIFY);
        |                                 ^~~~~~
  gmake[2]: *** [collision_detection/CMakeFiles/moveit_collision_detection.dir/build.make:149: collision_detection/CMakeFiles/moveit_collision_detection.dir/src/world.cpp.o] Error 1
  gmake[1]: *** [CMakeFiles/Makefile2:2189: collision_detection/CMakeFiles/moveit_collision_detection.dir/all] Error 2
  gmake: *** [Makefile:149: all] Error 2
  ---
  Failed   <<< moveit_core [2.52s, exited with code 2]

  Summary: 0 packages finished [2.98s]
    1 package failed: moveit_core
    1 package had stderr output: moveit_core
generate_code.cpp: |-
  bool World::moveShapeInObject(const std::string& object_id, const shapes::ShapeConstPtr& shape,
                                const Eigen::Isometry3d& shape_pose)
  {
      // Find the object by its ID
      auto it = objects_.find(object_id);
      if (it == objects_.end())
      {
          // Object not found
          return false;
      }

      // Get the object pointer
      ObjectPtr& obj = it->second;

      // Ensure the object is unique before modifying it
      ensureUnique(obj);

      // Iterate through the shapes in the object to find the target shape
      for (size_t i = 0; i < obj->shapes_.size(); ++i)
      {
          if (obj->shapes_[i] == shape)
          {
              // Update the pose of the shape
              obj->shape_poses_[i] = shape_pose;

              // Notify about the change
              notify(obj, Action::MODIFY);

              // Shape found and moved successfully
              return true;
          }
      }

      // Shape not found in the object
      return false;
  }
ground_truth.cpp: |-
  bool World::moveShapeInObject(const std::string& object_id, const shapes::ShapeConstPtr& shape,
                                const Eigen::Isometry3d& shape_pose)
  {
    const auto it = objects_.find(object_id);
    if (it != objects_.end())
    {
      const unsigned int n = it->second->shapes_.size();
      for (unsigned int i = 0; i < n; ++i)
        if (it->second->shapes_[i] == shape)
        {
          ensureUnique(it->second);
          ASSERT_ISOMETRY(shape_pose)  // unsanitized input, could contain a non-isometry
          it->second->shape_poses_[i] = shape_pose;
          it->second->global_shape_poses_[i] = it->second->pose_ * shape_pose;

          notify(it->second, MOVE_SHAPE);
          return true;
        }
    }
    return false;
  }
