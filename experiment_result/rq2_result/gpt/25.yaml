compilation.log: |
  Starting >>> autoware_autonomous_emergency_braking
  --- stderr: autoware_autonomous_emergency_braking
  /workspace/repos/autoware/src/universe/autoware.universe/control/autoware_autonomous_emergency_braking/src/node.cpp: In member function ‘void autoware::motion::control::autonomous_emergency_braking::AEB::onImu(sensor_msgs::msg::Imu_<std::allocator<void> >::ConstSharedPtr)’:
  /workspace/repos/autoware/src/universe/autoware.universe/control/autoware_autonomous_emergency_braking/src/node.cpp:295:26: error: ‘getTransform’ was not declared in this scope; did you mean ‘autoware::motion::control::autonomous_emergency_braking::utils::getTransform’?
    295 |     auto transform_opt = getTransform("base_link", input_msg->header.frame_id, tf_buffer_, this->get_logger());
        |                          ^~~~~~~~~~~~
        |                          autoware::motion::control::autonomous_emergency_braking::utils::getTransform
  In file included from /workspace/repos/autoware/src/universe/autoware.universe/control/autoware_autonomous_emergency_braking/src/node.cpp:16:
  /workspace/repos/autoware/src/universe/autoware.universe/control/autoware_autonomous_emergency_braking/include/autoware/autonomous_emergency_braking/utils.hpp:121:53: note: ‘autoware::motion::control::autonomous_emergency_braking::utils::getTransform’ declared here
    121 | std::optional<geometry_msgs::msg::TransformStamped> getTransform(
        |                                                     ^~~~~~~~~~~~
  gmake[2]: *** [CMakeFiles/autoware_autonomous_emergency_braking_node.dir/build.make:76: CMakeFiles/autoware_autonomous_emergency_braking_node.dir/src/node.cpp.o] Error 1
  gmake[1]: *** [CMakeFiles/Makefile2:187: CMakeFiles/autoware_autonomous_emergency_braking_node.dir/all] Error 2
  gmake: *** [Makefile:146: all] Error 2
  ---
  Failed   <<< autoware_autonomous_emergency_braking [18.2s, exited with code 2]

  Summary: 0 packages finished [19.5s]
    1 package failed: autoware_autonomous_emergency_braking
    1 package had stderr output: autoware_autonomous_emergency_braking
generate_code.cpp: |-
  void AEB::onImu(const Imu::ConstSharedPtr input_msg)
  {
      // Extract the angular velocity from the input IMU message
      const auto & angular_velocity = input_msg->angular_velocity;

      // Get the transform from the IMU frame to the base_link frame
      auto transform_opt = getTransform("base_link", input_msg->header.frame_id, tf_buffer_, this->get_logger());

      if (!transform_opt.has_value())
      {
          RCLCPP_WARN(this->get_logger(), "Failed to get transform from %s to base_link", input_msg->header.frame_id.c_str());
          return;
      }

      const auto & transform = transform_opt.value();

      // Transform the angular velocity to the base_link frame
      geometry_msgs::msg::Vector3Stamped angular_velocity_stamped;
      angular_velocity_stamped.header = input_msg->header;
      angular_velocity_stamped.vector = angular_velocity;

      geometry_msgs::msg::Vector3Stamped angular_velocity_transformed;
      try
      {
          tf2::doTransform(angular_velocity_stamped, angular_velocity_transformed, transform);
      }
      catch (const tf2::TransformException & ex)
      {
          RCLCPP_ERROR(this->get_logger(), "Failed to transform angular velocity: %s", ex.what());
          return;
      }

      // Store the transformed angular velocity
      angular_velocity_ptr_ = std::make_shared<geometry_msgs::msg::Vector3>(angular_velocity_transformed.vector);
  }
ground_truth.cpp: |-
  void AEB::onImu(const Imu::ConstSharedPtr input_msg)
  {
    // transform imu
    const auto logger = get_logger();
    const auto transform_stamped =
      utils::getTransform("base_link", input_msg->header.frame_id, tf_buffer_, logger);
    if (!transform_stamped.has_value()) return;

    angular_velocity_ptr_ = std::make_shared<Vector3>();
    tf2::doTransform(input_msg->angular_velocity, *angular_velocity_ptr_, transform_stamped.value());
  }
