compilation.log: |
  Starting >>> nav2_mppi_controller
  --- stderr: nav2_mppi_controller
  /root/repos/nav_ws/src/nav2_mppi_controller/src/critics/twirling_critic.cpp: In member function ‘virtual void mppi::critics::TwirlingCritic::score(mppi::CriticData&)’:
  /root/repos/nav_ws/src/nav2_mppi_controller/src/critics/twirling_critic.cpp:34:42: error: ‘struct mppi::CriticData’ has no member named ‘pose_tolerance’
     34 |     if (withinPositionGoalTolerance(data.pose_tolerance, data.robot_pose, data.goal_pose)) {
        |                                          ^~~~~~~~~~~~~~
  /root/repos/nav_ws/src/nav2_mppi_controller/src/critics/twirling_critic.cpp:34:63: error: ‘struct mppi::CriticData’ has no member named ‘robot_pose’
     34 |     if (withinPositionGoalTolerance(data.pose_tolerance, data.robot_pose, data.goal_pose)) {
        |                                                               ^~~~~~~~~~
  /root/repos/nav_ws/src/nav2_mppi_controller/src/critics/twirling_critic.cpp:34:80: error: ‘struct mppi::CriticData’ has no member named ‘goal_pose’
     34 |     if (withinPositionGoalTolerance(data.pose_tolerance, data.robot_pose, data.goal_pose)) {
        |                                                                                ^~~~~~~~~
  /root/repos/nav_ws/src/nav2_mppi_controller/src/critics/twirling_critic.cpp:34:9: error: ‘withinPositionGoalTolerance’ was not declared in this scope; did you mean ‘mppi::utils::withinPositionGoalTolerance’?
     34 |     if (withinPositionGoalTolerance(data.pose_tolerance, data.robot_pose, data.goal_pose)) {
        |         ^~~~~~~~~~~~~~~~~~~~~~~~~~~
        |         mppi::utils::withinPositionGoalTolerance
  In file included from /root/repos/nav_ws/src/nav2_mppi_controller/include/nav2_mppi_controller/critics/twirling_critic.hpp:19,
                   from /root/repos/nav_ws/src/nav2_mppi_controller/src/critics/twirling_critic.cpp:15:
  /root/repos/nav_ws/src/nav2_mppi_controller/include/nav2_mppi_controller/tools/utils.hpp:233:13: note: ‘mppi::utils::withinPositionGoalTolerance’ declared here
    233 | inline bool withinPositionGoalTolerance(
        |             ^~~~~~~~~~~~~~~~~~~~~~~~~~~
  /root/repos/nav_ws/src/nav2_mppi_controller/src/critics/twirling_critic.cpp:36:52: error: ‘struct mppi::CriticData’ has no member named ‘cmd_vel’
     36 |         double rotational_velocity = std::abs(data.cmd_vel.angular.z);
        |                                                    ^~~~~~~
  /root/repos/nav_ws/src/nav2_mppi_controller/src/critics/twirling_critic.cpp:37:53: error: ‘struct mppi::CriticData’ has no member named ‘penalty_weight’
     37 |         double penalty = rotational_velocity * data.penalty_weight;
        |                                                     ^~~~~~~~~~~~~~
  /root/repos/nav_ws/src/nav2_mppi_controller/src/critics/twirling_critic.cpp:40:14: error: ‘struct mppi::CriticData’ has no member named ‘cost’; did you mean ‘costs’?
     40 |         data.cost += penalty;
        |              ^~~~
        |              costs
  gmake[2]: *** [CMakeFiles/mppi_critics.dir/build.make:202: CMakeFiles/mppi_critics.dir/src/critics/twirling_critic.cpp.o] Error 1
  gmake[1]: *** [CMakeFiles/Makefile2:222: CMakeFiles/mppi_critics.dir/all] Error 2
  gmake: *** [Makefile:146: all] Error 2
  ---
  Failed   <<< nav2_mppi_controller [5.89s, exited with code 2]

  Summary: 0 packages finished [6.18s]
    1 package failed: nav2_mppi_controller
    1 package had stderr output: nav2_mppi_controller
generate_code.cpp: |-
  void TwirlingCritic::score(CriticData & data)
  {
      // Check if the robot is within the position goal tolerance
      if (withinPositionGoalTolerance(data.pose_tolerance, data.robot_pose, data.goal_pose)) {
          // Apply a penalty based on the rotational velocity
          double rotational_velocity = std::abs(data.cmd_vel.angular.z);
          double penalty = rotational_velocity * data.penalty_weight;

          // Update the cumulative cost in the CriticData
          data.cost += penalty;
      }
  }
ground_truth.cpp: |-
  void TwirlingCritic::score(CriticData & data)
  {
    using xt::evaluation_strategy::immediate;
    if (!enabled_ ||
      utils::withinPositionGoalTolerance(data.goal_checker, data.state.pose.pose, data.goal))
    {
      return;
    }

    const auto wz = xt::abs(data.state.wz);
    data.costs += xt::pow(xt::mean(wz, {1}, immediate) * weight_, power_);
  }
