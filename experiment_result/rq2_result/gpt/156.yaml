compilation.log: |
  Starting >>> nav2_util
  Finished <<< nav2_util [0.34s]

  Summary: 1 package finished [0.65s]
generate_code.cpp: |-
  OdomSmoother::OdomSmoother(
    const rclcpp::Node::WeakPtr & parent,
    double filter_duration,
    const std::string & odom_topic)
  : odom_history_duration_(rclcpp::Duration::from_seconds(filter_duration))
  {
    // Lock the mutex to ensure thread safety during initialization
    std::lock_guard<std::mutex> lock(odom_mutex_);

    // Get the shared pointer to the parent node
    auto node = parent.lock();
    if (!node) {
      throw std::runtime_error("Failed to lock parent node pointer.");
    }

    // Initialize the odometry subscription
    odom_sub_ = node->create_subscription<nav_msgs::msg::Odometry>(
      odom_topic,
      rclcpp::QoS(10),
      std::bind(&OdomSmoother::odomCallback, this, std::placeholders::_1)
    );

    // Initialize the cumulative odometry and smoothed velocity message
    odom_cumulate_ = nav_msgs::msg::Odometry();
    vel_smooth_ = geometry_msgs::msg::TwistStamped();
  }
ground_truth.cpp: |-
  OdomSmoother::OdomSmoother(
    const rclcpp::Node::WeakPtr & parent,
    double filter_duration,
    const std::string & odom_topic)
  : odom_history_duration_(rclcpp::Duration::from_seconds(filter_duration))
  {
    auto node = parent.lock();
    odom_sub_ = node->create_subscription<nav_msgs::msg::Odometry>(
      odom_topic,
      rclcpp::SystemDefaultsQoS(),
      std::bind(&OdomSmoother::odomCallback, this, std::placeholders::_1));

    odom_cumulate_.twist.twist.linear.x = 0;
    odom_cumulate_.twist.twist.linear.y = 0;
    odom_cumulate_.twist.twist.linear.z = 0;
    odom_cumulate_.twist.twist.angular.x = 0;
    odom_cumulate_.twist.twist.angular.y = 0;
    odom_cumulate_.twist.twist.angular.z = 0;
  }
