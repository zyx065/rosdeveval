compilation.log: |
  Starting >>> autoware_freespace_planner
  --- stderr: autoware_freespace_planner
  /workspace/repos/autoware/src/universe/autoware.universe/planning/autoware_freespace_planner/src/autoware_freespace_planner/freespace_planner_node.cpp: In constructor ‘autoware::freespace_planner::FreespacePlannerNode::FreespacePlannerNode(const rclcpp::NodeOptions&)’:
  /workspace/repos/autoware/src/universe/autoware.universe/planning/autoware_freespace_planner/src/autoware_freespace_planner/freespace_planner_node.cpp:79:49: error: ‘tier4_debug_msgs’ was not declared in this scope; did you mean ‘tier4_planning_msgs’?
     79 |   processing_time_pub_ = this->create_publisher<tier4_debug_msgs::msg::Float64Stamped>("debug/processing_time", 1);
        |                                                 ^~~~~~~~~~~~~~~~
        |                                                 tier4_planning_msgs
  /workspace/repos/autoware/src/universe/autoware.universe/planning/autoware_freespace_planner/src/autoware_freespace_planner/freespace_planner_node.cpp:79:32: error: parse error in template argument list
     79 |   processing_time_pub_ = this->create_publisher<tier4_debug_msgs::msg::Float64Stamped>("debug/processing_time", 1);
        |                                ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  /workspace/repos/autoware/src/universe/autoware.universe/planning/autoware_freespace_planner/src/autoware_freespace_planner/freespace_planner_node.cpp:79:87: error: no matching function for call to ‘autoware::freespace_planner::FreespacePlannerNode::create_publisher<<expression error> >(const char [22], int)’
     79 |   processing_time_pub_ = this->create_publisher<tier4_debug_msgs::msg::Float64Stamped>("debug/processing_time", 1);
        |                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /opt/ros/humble/include/rclcpp/rclcpp/node.hpp:1321,
                   from /opt/ros/humble/include/rclcpp/rclcpp/executors/single_threaded_executor.hpp:28,
                   from /opt/ros/humble/include/rclcpp/rclcpp/executors.hpp:22,
                   from /opt/ros/humble/include/rclcpp/rclcpp/rclcpp.hpp:155,
                   from /workspace/repos/autoware/install/autoware_universe_utils/include/autoware/universe_utils/ros/logger_level_configure.hpp:46,
                   from /workspace/repos/autoware/src/universe/autoware.universe/planning/autoware_freespace_planner/include/autoware/freespace_planner/freespace_planner_node.hpp:34,
                   from /workspace/repos/autoware/src/universe/autoware.universe/planning/autoware_freespace_planner/src/autoware_freespace_planner/freespace_planner_node.cpp:31:
  /opt/ros/humble/include/rclcpp/rclcpp/node_impl.hpp:73:1: note: candidate: ‘template<class MessageT, class AllocatorT, class PublisherT> std::shared_ptr<PublisherT> rclcpp::Node::create_publisher(const string&, const rclcpp::QoS&, const rclcpp::PublisherOptionsWithAllocator<AllocatorT>&)’
     73 | Node::create_publisher(
        | ^~~~
  /opt/ros/humble/include/rclcpp/rclcpp/node_impl.hpp:73:1: note:   template argument deduction/substitution failed:
  /workspace/repos/autoware/src/universe/autoware.universe/planning/autoware_freespace_planner/src/autoware_freespace_planner/freespace_planner_node.cpp:79:87: error: template argument 1 is invalid
     79 |   processing_time_pub_ = this->create_publisher<tier4_debug_msgs::msg::Float64Stamped>("debug/processing_time", 1);
        |                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~
  gmake[2]: *** [CMakeFiles/freespace_planner_node.dir/build.make:76: CMakeFiles/freespace_planner_node.dir/src/autoware_freespace_planner/freespace_planner_node.cpp.o] Error 1
  gmake[1]: *** [CMakeFiles/Makefile2:159: CMakeFiles/freespace_planner_node.dir/all] Error 2
  gmake: *** [Makefile:146: all] Error 2
  ---
  Failed   <<< autoware_freespace_planner [10.9s, exited with code 2]

  Summary: 0 packages finished [12.4s]
    1 package failed: autoware_freespace_planner
    1 package had stderr output: autoware_freespace_planner
generate_code.cpp: |-
  FreespacePlannerNode::FreespacePlannerNode(const rclcpp::NodeOptions & node_options)
  : Node("freespace_planner", node_options)
  {
    // Load parameters from the parameter server
    node_param_.planning_algorithm = this->declare_parameter<std::string>("planning_algorithm", "astar");
    node_param_.waypoints_velocity = this->declare_parameter<double>("waypoints_velocity", 10.0);
    node_param_.update_rate = this->declare_parameter<double>("update_rate", 10.0);
    node_param_.th_arrived_distance_m = this->declare_parameter<double>("th_arrived_distance_m", 1.0);
    node_param_.th_stopped_time_sec = this->declare_parameter<double>("th_stopped_time_sec", 1.0);
    node_param_.th_stopped_velocity_mps = this->declare_parameter<double>("th_stopped_velocity_mps", 0.1);
    node_param_.th_course_out_distance_m = this->declare_parameter<double>("th_course_out_distance_m", 0.5);
    node_param_.th_obstacle_time_sec = this->declare_parameter<double>("th_obstacle_time_sec", 2.0);
    node_param_.vehicle_shape_margin_m = this->declare_parameter<double>("vehicle_shape_margin_m", 0.1);
    node_param_.replan_when_obstacle_found = this->declare_parameter<bool>("replan_when_obstacle_found", true);
    node_param_.replan_when_course_out = this->declare_parameter<bool>("replan_when_course_out", true);

    vehicle_shape_.length = this->declare_parameter<double>("vehicle_shape.length", 4.5);
    vehicle_shape_.width = this->declare_parameter<double>("vehicle_shape.width", 2.0);
    vehicle_shape_.base_length = this->declare_parameter<double>("vehicle_shape.base_length", 2.7);
    vehicle_shape_.max_steering = this->declare_parameter<double>("vehicle_shape.max_steering", 0.5);
    vehicle_shape_.base2back = this->declare_parameter<double>("vehicle_shape.base2back", 1.0);
    vehicle_shape_.min_dimension = std::min(vehicle_shape_.length, vehicle_shape_.width);
    vehicle_shape_.max_dimension = std::max(vehicle_shape_.length, vehicle_shape_.width);

    // Initialize publishers
    trajectory_pub_ = this->create_publisher<Trajectory>("output/trajectory", 1);
    debug_pose_array_pub_ = this->create_publisher<PoseArray>("debug/pose_array", 1);
    debug_partial_pose_array_pub_ = this->create_publisher<PoseArray>("debug/partial_pose_array", 1);
    parking_state_pub_ = this->create_publisher<std_msgs::msg::Bool>("output/parking_state", 1);
    processing_time_pub_ = this->create_publisher<tier4_debug_msgs::msg::Float64Stamped>("debug/processing_time", 1);

    // Initialize subscription
    route_sub_ = this->create_subscription<LaneletRoute>(
      "input/route", 1, std::bind(&FreespacePlannerNode::onRoute, this, std::placeholders::_1));

    // Initialize TF buffer and listener
    tf_buffer_ = std::make_shared<tf2_ros::Buffer>(this->get_clock());
    tf_listener_ = std::make_shared<tf2_ros::TransformListener>(*tf_buffer_);

    // Initialize logger configuration
    logger_configure_ = std::make_unique<autoware::universe_utils::LoggerLevelConfigure>(this);

    // Initialize planning algorithm
    initializePlanningAlgorithm();

    // Set up timer for periodic updates
    const auto timer_period = std::chrono::duration<double>(1.0 / node_param_.update_rate);
    timer_ = this->create_wall_timer(timer_period, std::bind(&FreespacePlannerNode::onTimer, this));
  }
ground_truth.cpp: |-
  FreespacePlannerNode::FreespacePlannerNode(const rclcpp::NodeOptions & node_options)
  : Node("freespace_planner", node_options)
  {
    using std::placeholders::_1;

    // NodeParam
    {
      auto & p = node_param_;
      p.planning_algorithm = declare_parameter<std::string>("planning_algorithm");
      p.waypoints_velocity = declare_parameter<double>("waypoints_velocity");
      p.update_rate = declare_parameter<double>("update_rate");
      p.th_arrived_distance_m = declare_parameter<double>("th_arrived_distance_m");
      p.th_stopped_time_sec = declare_parameter<double>("th_stopped_time_sec");
      p.th_stopped_velocity_mps = declare_parameter<double>("th_stopped_velocity_mps");
      p.th_course_out_distance_m = declare_parameter<double>("th_course_out_distance_m");
      p.th_obstacle_time_sec = declare_parameter<double>("th_obstacle_time_sec");
      p.vehicle_shape_margin_m = declare_parameter<double>("vehicle_shape_margin_m");
      p.replan_when_obstacle_found = declare_parameter<bool>("replan_when_obstacle_found");
      p.replan_when_course_out = declare_parameter<bool>("replan_when_course_out");
    }

    // set vehicle_info
    {
      const auto vehicle_info =
        autoware::vehicle_info_utils::VehicleInfoUtils(*this).getVehicleInfo();
      vehicle_shape_.length = vehicle_info.vehicle_length_m;
      vehicle_shape_.width = vehicle_info.vehicle_width_m;
      vehicle_shape_.base_length = vehicle_info.wheel_base_m;
      vehicle_shape_.max_steering = vehicle_info.max_steer_angle_rad;
      vehicle_shape_.base2back = vehicle_info.rear_overhang_m;
    }

    // Planning
    initializePlanningAlgorithm();

    // Subscribers
    route_sub_ = create_subscription<LaneletRoute>(
      "~/input/route", rclcpp::QoS{1}.transient_local(),
      std::bind(&FreespacePlannerNode::onRoute, this, _1));

    // Publishers
    {
      rclcpp::QoS qos{1};
      qos.transient_local();  // latch
      trajectory_pub_ = create_publisher<Trajectory>("~/output/trajectory", qos);
      debug_pose_array_pub_ = create_publisher<PoseArray>("~/debug/pose_array", qos);
      debug_partial_pose_array_pub_ = create_publisher<PoseArray>("~/debug/partial_pose_array", qos);
      parking_state_pub_ = create_publisher<std_msgs::msg::Bool>("is_completed", qos);
      processing_time_pub_ = create_publisher<autoware_internal_debug_msgs::msg::Float64Stamped>(
        "~/debug/processing_time_ms", 1);
    }

    // TF
    {
      tf_buffer_ = std::make_shared<tf2_ros::Buffer>(get_clock());
      tf_listener_ = std::make_shared<tf2_ros::TransformListener>(*tf_buffer_);
    }

    // Timer
    {
      const auto period_ns = rclcpp::Rate(node_param_.update_rate).period();
      timer_ = rclcpp::create_timer(
        this, get_clock(), period_ns, std::bind(&FreespacePlannerNode::onTimer, this));
    }

    logger_configure_ = std::make_unique<autoware::universe_utils::LoggerLevelConfigure>(this);
  }
