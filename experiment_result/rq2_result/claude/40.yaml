compilation.log: |
  Starting >>> autoware_traffic_light_arbiter
  Finished <<< autoware_traffic_light_arbiter [18.4s]

  Summary: 1 package finished [19.9s]
generate_code.cpp: |-
  TrafficLightArbiter::TrafficLightArbiter(const rclcpp::NodeOptions & options)
  : Node("traffic_light_arbiter", options)
  {
      // Declare and get parameters with default values
      external_time_tolerance_ = declare_parameter<double>("external_time_tolerance", 1.0);
      perception_time_tolerance_ = declare_parameter<double>("perception_time_tolerance", 1.0);
      external_priority_ = declare_parameter<bool>("external_priority", false);
      enable_signal_matching_ = declare_parameter<bool>("enable_signal_matching", true);

      // Subscribe to map topic
      map_sub_ = create_subscription<LaneletMapBin>(
          "input/map", rclcpp::QoS(1),
          std::bind(&TrafficLightArbiter::onMap, this, std::placeholders::_1)
      );

      // Subscribe to perception traffic light recognition topic
      perception_tlr_sub_ = create_subscription<TrafficSignalArray>(
          "input/perception/traffic_lights", rclcpp::QoS(1),
          std::bind(&TrafficLightArbiter::onPerceptionMsg, this, std::placeholders::_1)
      );

      // Subscribe to external traffic light recognition topic
      external_tlr_sub_ = create_subscription<TrafficSignalArray>(
          "input/external/traffic_lights", rclcpp::QoS(1),
          std::bind(&TrafficLightArbiter::onExternalMsg, this, std::placeholders::_1)
      );

      // Publish arbitrated traffic light signals
      pub_ = create_publisher<TrafficSignalArray>(
          "output/traffic_lights", rclcpp::QoS(1)
      );
  }
ground_truth.cpp: |-
  TrafficLightArbiter::TrafficLightArbiter(const rclcpp::NodeOptions & options)
  : Node("traffic_light_arbiter", options)
  {
    external_delay_tolerance_ = this->declare_parameter<double>("external_delay_tolerance", 5.0);
    external_time_tolerance_ = this->declare_parameter<double>("external_time_tolerance", 5.0);
    perception_time_tolerance_ = this->declare_parameter<double>("perception_time_tolerance", 1.0);
    external_priority_ = this->declare_parameter<bool>("external_priority", false);
    enable_signal_matching_ = this->declare_parameter<bool>("enable_signal_matching", false);

    if (enable_signal_matching_) {
      signal_match_validator_ = std::make_unique<SignalMatchValidator>();
      signal_match_validator_->setExternalPriority(external_priority_);
    }

    map_sub_ = create_subscription<LaneletMapBin>(
      "~/sub/vector_map", rclcpp::QoS(1).transient_local(),
      std::bind(&TrafficLightArbiter::onMap, this, std::placeholders::_1));

    perception_tlr_sub_ = create_subscription<TrafficSignalArray>(
      "~/sub/perception_traffic_signals", rclcpp::QoS(1),
      std::bind(&TrafficLightArbiter::onPerceptionMsg, this, std::placeholders::_1));

    external_tlr_sub_ = create_subscription<TrafficSignalArray>(
      "~/sub/external_traffic_signals", rclcpp::QoS(1),
      std::bind(&TrafficLightArbiter::onExternalMsg, this, std::placeholders::_1));

    pub_ = create_publisher<TrafficSignalArray>("~/pub/traffic_signals", rclcpp::QoS(1));
  }
architecture-codes:
  - ROS Parameter Related Issues - Insufficient Parameter Design
  - ROS Parameter Related Issues - Parameter Default Value Mismatch
  - Topic/Service Related Issues - Topic Name Mismatch Issues
  - Topic/Service Related Issues - QoS Policy Incompatibility
functionality-codes:
  - Incomplete Code - Missing Multiple Steps
  - Conditional Checks Issues - Conditional Check Missing
root-cause-codes:
  - Deficiencies in Domain Knowledge - Insufficient understanding of ROS Programming
  - Inadequate Comprehension of Functional Logic - Inadequate Understanding of Task Logic
  - Weakness in System-Level Integration - Lack of familiarity with the existing codebase
