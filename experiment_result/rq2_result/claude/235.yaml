compilation.log: |
  Starting >>> autoware_trajectory_follower_node
  --- stderr: autoware_trajectory_follower_node
  /workspace/repos/autoware/src/universe/autoware.universe/control/autoware_trajectory_follower_node/src/controller_node.cpp: In member function ‘void autoware::motion::control::trajectory_follower_node::Controller::callbackTimerControl()’:
  /workspace/repos/autoware/src/universe/autoware.universe/control/autoware_trajectory_follower_node/src/controller_node.cpp:209:10: error: ‘input_data_’ was not declared in this scope; did you mean ‘InputData’?
    209 |     if (!input_data_) {
        |          ^~~~~~~~~~~
        |          InputData
  /workspace/repos/autoware/src/universe/autoware.universe/control/autoware_trajectory_follower_node/src/controller_node.cpp:215:40: error: ‘input_data_’ was not declared in this scope; did you mean ‘InputData’?
    215 |     if (!lateral_controller_->isReady(*input_data_) ||
        |                                        ^~~~~~~~~~~
        |                                        InputData
  /workspace/repos/autoware/src/universe/autoware.universe/control/autoware_trajectory_follower_node/src/controller_node.cpp:222:59: error: ‘input_data_’ was not declared in this scope; did you mean ‘InputData’?
    222 |     const auto lateral_output = lateral_controller_->run(*input_data_);
        |                                                           ^~~~~~~~~~~
        |                                                           InputData
  /workspace/repos/autoware/src/universe/autoware.universe/control/autoware_trajectory_follower_node/src/controller_node.cpp:247:5: error: ‘publishControlCommands’ was not declared in this scope
    247 |     publishControlCommands(
        |     ^~~~~~~~~~~~~~~~~~~~~~
  gmake[2]: *** [CMakeFiles/controller_node.dir/build.make:76: CMakeFiles/controller_node.dir/src/controller_node.cpp.o] Error 1
  gmake[1]: *** [CMakeFiles/Makefile2:163: CMakeFiles/controller_node.dir/all] Error 2
  gmake: *** [Makefile:146: all] Error 2
  ---
  Failed   <<< autoware_trajectory_follower_node [11.5s, exited with code 2]

  Summary: 0 packages finished [12.9s]
    1 package failed: autoware_trajectory_follower_node
    1 package had stderr output: autoware_trajectory_follower_node
generate_code.cpp: |
  void Controller::callbackTimerControl()
  {
      // Check if input data is available
      if (!input_data_) {
          RCLCPP_WARN(get_logger(), "Input data is not available");
          return;
      }

      // Check if lateral and longitudinal controllers are ready
      if (!lateral_controller_->isReady(*input_data_) || 
          !longitudinal_controller_->isReady(*input_data_)) {
          RCLCPP_WARN(get_logger(), "Controllers are not ready");
          return;
      }

      // Run lateral controller
      const auto lateral_output = lateral_controller_->run(*input_data_);

      // Run longitudinal controller
      const auto longitudinal_output = longitudinal_controller_->run(*input_data_);

      // Synchronize controllers
      lateral_controller_->sync(longitudinal_output.sync_data);
      longitudinal_controller_->sync(lateral_output.sync_data);

      // Merge lateral and longitudinal horizons
      const auto control_horizon = mergeLatLonHorizon(
          lateral_output.control_cmd_horizon, 
          longitudinal_output.control_cmd_horizon, 
          input_data_->current_trajectory.header.stamp
      );

      if (!control_horizon) {
          RCLCPP_WARN(get_logger(), "Failed to merge control horizons");
          return;
      }

      // Publish debug markers
      publishDebugMarker(*input_data_, lateral_output);

      // Publish control commands
      publishControlCommands(
          lateral_output.control_cmd, 
          longitudinal_output.control_cmd
      );
  }
ground_truth.cpp: |-
  void Controller::callbackTimerControl()
  {
    // 1. create input data
    const auto input_data = createInputData(*get_clock());
    if (!input_data) {
      RCLCPP_INFO_THROTTLE(
        get_logger(), *get_clock(), 5000, "Control is skipped since input data is not ready.");
      return;
    }

    // 2. check if controllers are ready
    const bool is_lat_ready = lateral_controller_->isReady(*input_data);
    const bool is_lon_ready = longitudinal_controller_->isReady(*input_data);
    if (!is_lat_ready || !is_lon_ready) {
      RCLCPP_INFO_THROTTLE(
        get_logger(), *get_clock(), 5000,
        "Control is skipped since lateral and/or longitudinal controllers are not ready to run.");
      return;
    }

    // 3. run controllers
    stop_watch_.tic("lateral");
    const auto lat_out = lateral_controller_->run(*input_data);
    publishProcessingTime(stop_watch_.toc("lateral"), pub_processing_time_lat_ms_);

    stop_watch_.tic("longitudinal");
    const auto lon_out = longitudinal_controller_->run(*input_data);
    publishProcessingTime(stop_watch_.toc("longitudinal"), pub_processing_time_lon_ms_);

    // 4. sync with each other controllers
    longitudinal_controller_->sync(lat_out.sync_data);
    lateral_controller_->sync(lon_out.sync_data);

    // TODO(Horibe): Think specification. This comes from the old implementation.
    if (isTimeOut(lon_out, lat_out)) return;

    // 5. publish control command
    autoware_control_msgs::msg::Control out;
    out.stamp = this->now();
    out.lateral = lat_out.control_cmd;
    out.longitudinal = lon_out.control_cmd;
    control_cmd_pub_->publish(out);

    // 6. publish debug
    published_time_publisher_->publish_if_subscribed(control_cmd_pub_, out.stamp);
    publishDebugMarker(*input_data, lat_out);

    // 7. publish experimental topic
    if (enable_control_cmd_horizon_pub_) {
      const auto control_horizon =
        mergeLatLonHorizon(lat_out.control_cmd_horizon, lon_out.control_cmd_horizon, this->now());
      if (control_horizon.has_value()) {
        control_cmd_horizon_pub_->publish(control_horizon.value());
      }
    }
  }
architecture-codes:
  - ROS Logger Issues - Inappropriate Log Level Usage
  - Topic/Service Related Issues - Topic Not Use
  - Topic/Service Related Issues - Incomplete Topic Initialization Issues
  - ROS Message Related Issues - Message Initialization Issues
  - ROS Timer Issues - Timestamp Processing Missing
  - ROS Timer Issues - Timestamp Processing Errors

functionality-codes:
  - Reference Error - Undefined Name
  - Incomplete Code - Missing Multiple Steps
  - Conditional Checks Issues - Conditional Check Missing
  - Operation/Calculation Error - Wrong Method Call

Root Cause Analysis:
  - Inadequate Comprehension of Functional Logic - Inadequate Understanding of Task Logic
  - Deficiencies in Domain Knowledge - Insufficient Understanding of ROS Programming
  - Deficiencies in Domain Knowledge - Lack of ROS Development Best Practices
  - Weakness in System-Level Integration - Lack of Familiarity with the Existing Codebase