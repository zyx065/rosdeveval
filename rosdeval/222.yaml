repository: navigation2
language: C++
ros_package_file: src/nav2_rotation_shim_controller
ros_package: nav2_rotation_shim_controller
file_path: src/nav2_rotation_shim_controller.cpp
method_name: computeRotateToHeadingCommand
requirement: |
  /**
   * @brief Rotates the robot to the rough heading
   * @param angular_distance Angular distance to the goal remaining
   * @param pose Starting pose of robot
   * @param velocity Starting velocity of robot
   * @return Twist command for rotation to rough heading
   */
category: utilities
type: has_message
signature: |
  geometry_msgs::msg::TwistStamped
  RotationShimController::computeRotateToHeadingCommand(
    const double & angular_distance_to_heading,
    const geometry_msgs::msg::PoseStamped & pose,
    const geometry_msgs::msg::Twist & velocity)
additional_information: 
  function_related_variable: | 
    rcl_interfaces::msg::SetParametersResult
    dynamicParametersCallback(std::vector<rclcpp::Parameter> parameters);

    rclcpp_lifecycle::LifecycleNode::WeakPtr node_;
    std::shared_ptr<tf2_ros::Buffer> tf_;
    std::string plugin_name_;
    rclcpp::Logger logger_ {rclcpp::get_logger("RotationShimController")};
    rclcpp::Clock::SharedPtr clock_;
    std::shared_ptr<nav2_costmap_2d::Costmap2DROS> costmap_ros_;
    std::unique_ptr<nav2_costmap_2d::FootprintCollisionChecker<nav2_costmap_2d::Costmap2D *>>
    collision_checker_;

    pluginlib::ClassLoader<nav2_core::Controller> lp_loader_;
    nav2_core::Controller::Ptr primary_controller_;
    bool path_updated_;
    nav_msgs::msg::Path current_path_;
    double forward_sampling_distance_, angular_dist_threshold_, angular_disengage_threshold_;
    double rotate_to_heading_angular_vel_, max_angular_accel_;
    double control_duration_, simulate_ahead_time_;
    bool rotate_to_goal_heading_, in_rotation_;
    bool closed_loop_;
    double last_angular_vel_ = std::numeric_limits<double>::max();

    // Dynamic parameters handler
    std::mutex mutex_;
    rclcpp::node_interfaces::OnSetParametersCallbackHandle::SharedPtr dyn_params_handler_;
    std::unique_ptr<nav2_controller::PositionGoalChecker> position_goal_checker_;
  function_related_function: | 
    void RotationShimController::isCollisionFree(const geometry_msgs::msg::TwistStamped & cmd_vel,const double & angular_distance_to_heading,const geometry_msgs::msg::PoseStamped & pose)
test: test_shim_controller
test_cases: 
- rotationAndTransformTests