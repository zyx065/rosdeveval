repository: autoware
language: C++
ros_package_file: src/universe/autoware.universe/planning/autoware_scenario_selector
ros_package: autoware_scenario_selector
file_path: src/node.cpp
method_name: ScenarioSelectorNode::ScenarioSelectorNode
requirement: |
  /**
  * @brief Constructs a ScenarioSelectorNode for managing autonomous driving scenario transitions.
  * 
  * @param node_options Configuration options for initializing the ROS2 node.
  */
category: ros_architecture
type: has_topic,has_timer,has_parameter,has_message
signature: |
  ScenarioSelectorNode::ScenarioSelectorNode(const rclcpp::NodeOptions & node_options)
  : Node("scenario_selector", node_options),
    current_scenario_(tier4_planning_msgs::msg::Scenario::EMPTY),
    update_rate_(this->declare_parameter<double>("update_rate")),
    th_max_message_delay_sec_(this->declare_parameter<double>("th_max_message_delay_sec")),
    th_arrived_distance_m_(this->declare_parameter<double>("th_arrived_distance_m")),
    th_stopped_time_sec_(this->declare_parameter<double>("th_stopped_time_sec")),
    th_stopped_velocity_mps_(this->declare_parameter<double>("th_stopped_velocity_mps")),
    enable_mode_switching_(this->declare_parameter<bool>("enable_mode_switching")),
    is_parking_completed_(false)
additional_information: 
  function_related_variable: |
    boost::optional<rclcpp::Time> lane_driving_stop_time_;
    boost::optional<rclcpp::Time> empty_parking_trajectory_time_;
    rclcpp::Subscription<autoware_map_msgs::msg::LaneletMapBin>::SharedPtr sub_lanelet_map_;
    rclcpp::Subscription<autoware_planning_msgs::msg::LaneletRoute>::SharedPtr sub_route_;
    rclcpp::Subscription<autoware_planning_msgs::msg::Trajectory>::SharedPtr sub_lane_driving_trajectory_;
    rclcpp::Subscription<autoware_planning_msgs::msg::Trajectory>::SharedPtr sub_parking_trajectory_;
    rclcpp::Publisher<autoware_planning_msgs::msg::Trajectory>::SharedPtr pub_trajectory_;
    rclcpp::Publisher<tier4_planning_msgs::msg::Scenario>::SharedPtr pub_scenario_;
    rclcpp::Publisher<tier4_debug_msgs::msg::Float64Stamped>::SharedPtr pub_processing_time_;
    universe_utils::InterProcessPollingSubscriber<nav_msgs::msg::Odometry, autoware::universe_utils::polling_policy::All>::SharedPtr sub_odom_;
    universe_utils::InterProcessPollingSubscriber<std_msgs::msg::Bool>::SharedPtr sub_parking_state_;
    universe_utils::InterProcessPollingSubscriber<autoware_adapi_v1_msgs::msg::OperationModeState>::SharedPtr sub_operation_mode_state_;
    rclcpp::TimerBase::SharedPtr timer_;
    std::unique_ptr<autoware::universe_utils::PublishedTimePublisher> published_time_publisher_;
  function_related_function: |
    void onTimer();
    void onMap(const autoware_map_msgs::msg::LaneletMapBin::ConstSharedPtr msg);
    void onRoute(const autoware_planning_msgs::msg::LaneletRoute::ConstSharedPtr msg);
    void onLaneDrivingTrajectory(const autoware_planning_msgs::msg::Trajectory::ConstSharedPtr msg);
    void onParkingTrajectory(const autoware_planning_msgs::msg::Trajectory::ConstSharedPtr msg);
    void publishTrajectory(const autoware_planning_msgs::msg::Trajectory::ConstSharedPtr msg);
test: autoware_scenario_selector
test_cases: []